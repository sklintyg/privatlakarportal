apply plugin: 'com.moowork.grunt'

grunt {
    colors = System.properties['gruntColors'] ? System.properties['gruntColors'].toBoolean() : true
}

node {
    version = '6.11.3'
    download = true
    distBaseUrl = 'https://build-inera.nordicmedtest.se/node/'
    workDir = projectDir
    nodeModulesDir = projectDir
}

task cypressTest(type: NodeTask, dependsOn: [yarn] ) {
    outputs.upToDateWhen { false }

    def ppUrl = System.properties['ppUrl'] ?: "http://localhost:8090"

    script = file('node_modules/cypress/bin/cypress')
    args = ['run', '--reporter', 'mochawesome', '--reporter-options', 'reportDir=build/test-results', '--env', 'ppUrl='+ppUrl]
}

dependencies {
    runtime project(':privatlakarportal-web')
}
